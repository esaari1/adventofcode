import numpy as np

a = np.zeros((21, 21, 28, 28), dtype=int)
a[10,10,10,10:18] = [0,1,1,0,0,0,1,0]
a[10,10,11,10:18] = [0,1,0,1,1,1,0,0]
a[10,10,12,10:18] = [0,0,1,1,0,1,0,1]
a[10,10,13,10:18] = [1,1,0,0,0,1,0,1]
a[10,10,14,10:18] = [1,0,0,1,0,0,0,1]
a[10,10,15,10:18] = [1,0,0,1,1,1,0,0]
a[10,10,16,10:18] = [0,1,1,0,1,1,1,1]
a[10,10,17,10:18] = [0,0,1,1,1,1,1,0]

#a = np.zeros((21, 21, 28, 28), dtype=int)
#a[10,10,10,10:13] = [0,1,0]
#a[10,10,11,10:13] = [0,0,1]
#a[10,10,12,10:13] = [1,1,1]

b = a.copy()

for i in range(6):
	print('i = ', i)
	for w in range(1,21):
		for z in range(1,21):
			for y in range(1,28):
				for x in range(1,28):
					s = np.sum(a[w-1:w+2,z-1:z+2,y-1:y+2,x-1:x+2]) - a[w,z,y,x]
					if a[w,z,y,x] == 1:
						if s != 2 and s != 3:
							b[w,z,y,x] = 0
					else:
						if s == 3:
							b[w,z,y,x] = 1

	a = b.copy()

print(np.count_nonzero(b == 1))
